<?php $method = $_GET['requesttype'];  try {	$id = uniqid();	$scheduleid = $_GET["scheduleid"];	$deviceid = $_GET["deviceid"];	$state = $_GET["state"];			    $jsonModel = './model/scheduledevice.json';		$json = '';	    switch($method)	{	  case 'create':	  	     if (file_exists($file)) 		 {		    $fileContent = '';				 	$json = $json.'"scheduledevice"{';			$json = $json.'"id":"'.uniqueid().'"';			$json = $json.'"scheduleid":"'.$scheduleid.'"';			$json = $json.'"deviceid":"'.$deviceid.'"';			$json = $json.'"state":"'.$state.'"';			$json = $json.'}';					    $data = file_get_contents($jsonModel, FILE_USE_INCLUDE_PATH);						if($data.length > 0)			{			  $fileContent = $data.'\r\n'.$json;			}			else			{			 $fileContent = $json;			}						file_put_contents($file, $fileContent);						echo '{"status":"200","message":'.$method.'" successfull!"}';		 }		 else		 {		    throw new Exception('No data model exists for schedule device!')		 }	  break;	  	  case 'update':	    $id = $_GET['id'];				$contentToUpdate = '';				if (file_exists($file)) 		{		    $fileContent = '';						$json = $json.'"scheduledevice"{';			$json = $json.'"id":"'.$id.'"';			$json = $json.'"scheduleid":"'.$scheduleid.'"';			$json = $json.'"deviceid":"'.$deviceid.'"';			$json = $json.'"state":"'.$state.'"';			$json = $json.'}';					    $data = file_get_contents($jsonModel, FILE_USE_INCLUDE_PATH);						$jsonModel = json_decode($data);						foreach($jsonModel->rows as $scheduledevice)			{ 			  if($scheduledevice->id == $id)			  {			    $contentToUpdate = $scheduledevice->text;				break;			  }			}						if($contentToRemove != '')			{			  $data = str_replace($contentToRemove,$data,$json);			  			  file_put_contents($file, $fileContent);			}						echo '{"status":"200","message":'.$method.'" successfull!"}';		 }		 else		 {		    throw new Exception('No data model exists for schedule device!')		 }	  break;	  	  case 'delete':	    $id = $_GET['id'];		$contentToRemove = '';				if (file_exists($file)) 		{		    $fileContent = '';					    $data = file_get_contents($jsonModel, FILE_USE_INCLUDE_PATH);						$jsonModel = json_decode($data);						foreach($jsonModel->rows as $scheduledevice)			{ 			  if($scheduledevice->id == $id)			  {			    $contentToRemove = $devicedevice->text;				break;			  }			}						if($contentToRemove != '')			{			  $data = str_replace($contentToRemove,$data,'');			  			  file_put_contents($file, $fileContent);			}						echo '{"status":"200","message":'.$method.'" successfull!"}';		 }		 else		 {		    throw new Exception('No data model exists for schedule device!')		 }	  break;	  	  case 'list':	     if (file_exists($file)) 	     {		    $data = file_get_contents($jsonModel, FILE_USE_INCLUDE_PATH);						echo $data;		 }		 else		 {		    throw new Exception('No data model exists for schedule!')		 }	  break;	  	  case 'get':	    $id = $_GET['id'];		$contentToDisplay = '';				if (file_exists($file)) 		{		    $fileContent = '';					    $data = file_get_contents($jsonModel, FILE_USE_INCLUDE_PATH);						$jsonModel = json_decode($data);						foreach($jsonModel->rows as $scheduledevice)			{ 			  if($scheduledevice->id == $id)			  {			    $contentToDisplay = $scheduledevice->text;				break;			  }			}						echo $contentToDisplay;		 }		 else		 {		    throw new Exception('No data model exists for schedule device!')		 }	  break;	} } catch(Exception $e) {   echo '{"status":"500","message":"Failed to execute "'.$method.'" for schedule device service.See more info section for details.", "more info" :'.$e->getMessage().'"}'; }?>